{% extends "admin/change_form.html" %}
{% load i18n admin_modify adminmedia %}

{% block extrahead %}{{ block.super }}

<link type="text/css" href="{{ STATIC_URL }}feincms/jquery-ui/jquery-ui-1.8.16.custom.css" rel="Stylesheet" />

{% block feincms_jquery_ui %}
<script type="text/javascript" src="{{ STATIC_URL }}feincms/jquery-1.7.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}feincms/jquery-ui-1.8.16.custom.min.js"></script>
{% endblock %}

<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}feincms/style.css" />

<script type="text/javascript" src="{{ STATIC_URL }}feincms/jquery.alerts.js"></script>
<script type="text/javascript">
    var feincms = {
        {% if FEINCMS_JQUERY_NO_CONFLICT %}
        "jQuery": jQuery.noConflict(true)
        {% else %}
        "jQuery": jQuery
        {% endif %}
    };
</script>
<script type="text/javascript" src="{{ STATIC_URL }}feincms/item_editor.js"></script>

{% include "admin/feincms/_messages_js.html" %}
{% include "admin/feincms/_regions_js.html" %}
{% include "admin/feincms/_content_type_buttons.html" %}

{% for inc in model.feincms_item_editor_includes.head %}{% include inc %}{% endfor %}

<script type="text/javascript">
    feincms.jQuery(document).ready(function($){
        {% block extra-init-js %}{# /* do not use this block, use feincms_item_editor_includes instead */ #}{% endblock %}
    });
</script>
{% endblock %}

{% block form_top %}
  {% with original.available_translations as translations %}
    {% if translations %}
      <div style="float: right;padding: 5px 0 0 0" id="available_translations">
        {% trans "available translations" %}:
        {% for translation in translations %}
          <a href="../{{ translation.id }}/" title="{{ translation }}">{{ translation.language|upper }}</a>{% if not forloop.last %},{% endif %}
        {% endfor %}
      </div>
      <script type="text/javascript">
        feincms.jQuery(function($){
            $('#id_language').parent().prepend($('#available_translations'));
        });
      </script>
    {% endif %}
  {% endwith %}
{% endblock %}

{% block after_related_objects %} {# as good a place as any... #}
  {{ block.super }}
  <div id="content-editor-fieldset" style="display: none">
    {% include "admin/feincms/content_editor.html" %}
  </div>
  <script type="text/javascript">
    feincms.jQuery(function($){

// begin options as tabs //
$('fieldset.feincms-collapse:first').before('<div id="tabs"><ul></ul></div>');

$('fieldset.feincms-collapse h2').contents().each(function(i, c) {
  $('#tabs ul').append('<li class="navi_tab"><a href="#tabs-' + i + '">' + c.textContent + '</a></li>');
});
$('fieldset.feincms-collapse').each(function(i, c) {
    $(c).attr('id', 'tabs-' + i);
});

var d = $('fieldset.feincms-collapse').remove().appendTo('#tabs');
$('fieldset.feincms-collapse > h2').remove();
$('#tabs').tabs({ collapsible: true, selected: -1 });

if(d = $('fieldset.feincms-collapse ul.errorlist:first').parents('fieldset').attr('id')) {
  $('#tabs').tabs('select', d);
}


$('fieldset').addClass('ui-corner-all');
$('.submit-row').addClass('ui-corner-all');
$('input').addClass('ui-corner-all');

// end options as tabs //

      $("h2:contains('{{ FEINCMS_CONTENT_FIELDSET_NAME }}')").parent().replaceWith($("#main_wrapper"));

    });
  </script>
{% endblock %}
